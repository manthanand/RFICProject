; Top Design: "ECE382M:Testbench:schematic"
; Netlisted using Hierarchy Policy: "Standard"

Options ResourceUsage=yes UseNutmegFormat=no EnableOptim=no TopDesignName="ECE382M:Testbench:schematic" DcopOutputNodeVoltages=yes DcopOutputPinCurrents=yes DcopOutputAllSweepPoints=no DcopOutputDcopType=0
; Library Name: ECE382M
; Cell Name: LNA_wrk
; View Name: schematic
define LNA_wrk ( Vdd  Vinn  Vinp  Voutn  Voutp ) 
;parameters 
#ifndef inc_ECE382M_3aLNA__wrk_3aschematic__130nm__bulk_2enet
#define inc_ECE382M_3aLNA__wrk_3aschematic__130nm__bulk_2enet 1
#include "C:\Users\manth\Github\RFICProject\ECE382M_wrk\130nm_bulk.net"
#endif
aele gain = (Voutp-Voutn)/Vin;
#uselib "ckt" , "INDQ_Z"
INDQ_Z:L8  Vdd Voutn L=Ldrain nH notune{ 5 nH to 20 nH by 1 nH } Q=15 F=3.75 GHz notune{ 1.875 GHz to 5.625 GHz by 0.375 GHz } Mode=1 Rdc=0.0 Ohm 
#uselib "ckt" , "INDQ_Z"
INDQ_Z:L5  Vdd Voutp L=Ldrain nH notune{ 5 nH to 20 nH by 1 nH } Q=15 F=3.75 GHz notune{ 1.875 GHz to 5.625 GHz by 0.375 GHz } Mode=1 Rdc=0.0 Ohm 
V_Source:SRC3  FBN 0 Type="V_DC" Vdc=vb V SaveCurrent=1 

width=24 tune{ 1 to 80 by 1 } opt{ 1 to 40 }
cap=34 f tune{ 0.5 f to 10000 f by 1 f }
Rdrain=300 tune{ 0 to 5000 by 100 } opt{ 1 to 40 }
Rtest=7 tune{ 0 to 25 by 1 } opt{ 1 to 40 }
vdd=1 tune{ 0 to 2.5 by 0.1 } opt{ 1 to 40 }
numcas=19 tune{ 1 to 40 by 1 } opt{ 1 to 40 }
wcas=22 tune{ 1 to 40 by 1 } opt{ 1 to 40 }
lencas=130 tune{ 130 to 4000 by 10 } opt{ 130 to 4000 }
vb=0.8 tune{ 0 to 2.5 by 0.05 }
len=170 tune{ 130 to 4000 by 10 } opt{ 130 to 4000 }
Ldrain=8.8 tune{ 0 to 10 by 0.5 } noopt{ 0 to 10 }
Lsource=1.2 tune{ 0 to 10 by 0.1 }
num=12 tune{ 1 to 40 by 1 } opt{ 1 to 40 }
R:R7  Vinp N__8 R=Rtest Ohm Noise=yes 
"nmos":MOSFET4  N__21 FBP N__8 0 Length=len nm Width=width um Mode=1 Noise=yes _M=num 
CAPQ:C1  Voutp Vdd C=cap F Q=50.0 F=3.75 GHz Mode=1 
CAPQ:C2  Voutn Vdd C=cap F Q=50.0 F=3.75 GHz Mode=1 
R:R10  Vdd Voutn R=Rdrain Ohm Noise=yes 
#uselib "ckt" , "INDQ_Z"
INDQ_Z:L7  N__15 0 L=Lsource nH notune{ 5 nH to 20 nH by 1 nH } Q=15 F=3.75 GHz Mode=1 Rdc=0.0 Ohm 
"nmos":MOSFET2  N__13 FBN N__15 0 Length=len nm Width=width um Mode=1 Noise=yes _M=num 
R:R9  Vdd Voutp R=Rdrain Ohm Noise=yes 
#uselib "ckt" , "INDQ_Z"
INDQ_Z:L6  N__8 0 L=Lsource nH notune{ 5 nH to 20 nH by 1 nH } Q=15 F=3.75 GHz Mode=1 Rdc=0.0 Ohm 
"nmos":MOSFET5  Voutn Vdd N__13 0 Length=lencas nm Width=wcas um Mode=1 Noise=yes _M=numcas 
"nmos":MOSFET6  Voutp Vdd N__21 0 Length=lencas nm Width=wcas um Mode=1 Noise=yes _M=numcas 
R:R8  Vinn N__15 R=Rtest Ohm Noise=yes 
V_Source:SRC2  FBP 0 Type="V_DC" Vdc=vb V SaveCurrent=1 
end LNA_wrk

; Library Name: ECE382M
; Cell Name: mixer
; View Name: schematic
define mixer ( LOn  LOp  vin1  vin2  Vout2  Vout1 ) 
;parameters 
#ifndef inc_ECE382M_3amixer_3aschematic__130nm__bulk_2enet
#define inc_ECE382M_3amixer_3aschematic__130nm__bulk_2enet 1
#include "C:\Users\manth\Github\RFICProject\ECE382M_wrk\130nm_bulk.net"
#endif
V_Source:SRC4  Vdd 0 Type="V_DC" Vdc=1.2 V Vac=0 SaveCurrent=1 
R:R2  Vout2 Vdd R=load Ohm Noise=yes 
R:R1  Vout1 Vdd R=load Ohm Noise=yes 
"nmos":MOSFET2  Vout1 N__1 vin1 0 Length=130 nm Width=width um Mode=1 Noise=yes 
"nmos":MOSFET4  Vout2 N__10 vin1 0 Length=130 nm Width=width um Mode=1 Noise=yes 
"nmos":MOSFET1  Vout1 N__12 vin2 0 Length=130 nm Width=width um Mode=1 Noise=yes 
"nmos":MOSFET3  Vout2 N__1 vin2 0 Length=130 nm Width=width um Mode=1 Noise=yes 

RFfreq=5
IFfreq=0.05
df=0.01
LOfreq=RFfreq-IFfreq
RFpower=-50
aele CG_linear=mag(mix(HB.Vout,{-1,1})/mix(HB.vin,{0,1}));CG_linear_p=mag(mix(HB.Vout2,{-1,1})/mix(HB.vin,{0,1}));CG_linear_n=mag(mix(HB.Vout1,{-1,1})/mix(HB.vin,{0,1}));CG_dB=20*log(CG_linear);CG_dB_p=20*log(CG_linear_p);CG_dB_n=20*log(CG_linear_n);

width=26.074 tune{ 0.1 to 100 by 1 }
turns=3.07e-06 tune{ 1e-06 to 1e-05 by 1e-06 }
load=9338 tune{ 100 to 10000 by 100 }
S_Param:SP1 CalcS=yes CalcY=no CalcZ=no GroupDelayAperture=1e-4 FreqConversion=no FreqConversionPort=1 StatusLevel=2 CalcNoise=no SortNoise=0 BandwidthForNoise=1.0 Hz DevOpPtLevel=0 SPSS_WSP=yes \
SweepVar="freq" SweepPlan="SP1_stim" OutputPlan="SP1_Output" 

SweepPlan: SP1_stim Start=1.0 GHz Stop=10.0 GHz Step=.1 GHz 

OutputPlan:SP1_Output \
      Type="Output" \
      UseEquationNestLevel=yes \
      EquationNestLevel=2 \
      UseSavedEquationNestLevel=yes \
      SavedEquationNestLevel=2

#load "python","LinearCollapse"
Component Module="LinearCollapse" Type="ModelExtractor" NetworkRepresentation=2
end mixer

V_Source:SRC1  N__17 0 Type="V_1Tone" V[1]=polar(1.2,0) V Freq[1]=LOfreq GHz    Vac=polar(1,0) V SaveCurrent=1 
V_Source:SRC2  N__19 0 Type="V_1Tone" V[1]=polar(1.2,180) V Freq[1]=LOfreq GHz    Vac=polar(1,0) V SaveCurrent=1 
C:C4  N__19 LO_In C=1 nF 
C:C3  N__17 LO_Ip C=1 nF 

RFfreq=5
IFfreq=0.05
df=0.01
LOfreq=RFfreq-IFfreq
RFpower=-50
S_Param:SP1 CalcS=yes CalcY=no CalcZ=no GroupDelayAperture=1e-4 FreqConversion=no FreqConversionPort=1 StatusLevel=2 CalcNoise=yes SortNoise=1 BandwidthForNoise=1.0 Hz DevOpPtLevel=0 SPSS_WSP=yes \
SweepVar="freq" SweepPlan="SP1_stim" OutputPlan="SP1_Output" 

SweepPlan: SP1_stim Start=1.0 GHz Stop=10 GHz Step=.1 GHz 

OutputPlan:SP1_Output \
      Type="Output" \
      UseEquationNestLevel=yes \
      EquationNestLevel=2 \
      UseSavedEquationNestLevel=yes \
      SavedEquationNestLevel=2

#load "python","LinearCollapse"
Component Module="LinearCollapse" Type="ModelExtractor" NetworkRepresentation=2
aele CG_linear=mag(mix(HB.Vout,{1,-1})/mix(HB.vin,{0,1}));CG_linear_p=mag(mix(HB.Vout2,{1,-1})/mix(HB.vin,{0,1}));CG_linear_n=mag(mix(HB.Vout1,{1,-1})/mix(HB.vin,{0,1}));CG_dB=20*log(CG_linear);CG_dB_p=20*log(CG_linear_p);CG_dB_n=20*log(CG_linear_n);
#uselib "ckt" , "Balun3Port"
Balun3Port:CMP1  Vout Vout1 Vout2 
Port:Term2  Vout 0 Num=2 Z=100 kOhm Noise=yes 
Port:Term1  N__12 0 Num=1 Z=50 Ohm Noise=yes 
Short:DC_Block2  N__12 vin Mode=1 
V_Source:SRC3  N__23 0 Type="V_DC" Vdc=1 V SaveCurrent=1 
V_Source:SRC6  N__27 0 Type="V_1Tone" V[1]=polar(1.2,90) V Freq[1]=LOfreq GHz    Vac=polar(1,0) V SaveCurrent=1 
C:C5  N__27 LO_Qp C=1 nF 
C:C6  N__30 LO_Qn C=1 nF 
V_Source:SRC5  N__30 0 Type="V_1Tone" V[1]=polar(1.2,270) V Freq[1]=LOfreq GHz    Vac=polar(1,0) V SaveCurrent=1 
Port:Term3  VoutQ 0 Num=3 Z=100 kOhm Noise=yes 
#uselib "ckt" , "Balun3Port"
Balun3Port:CMP2  VoutQ N__15 N__16 
LNA_wrk:X1  N__23 N__20 N__18 N__13 N__9 
#uselib "ckt" , "Balun3Port"
Balun3Port:CMP3  vin N__18 N__20 
mixer:X3  LO_Qn LO_Qp N__13 N__9 N__16 N__15 
mixer:X2  LO_In LO_Ip N__13 N__9 Vout2 Vout1 
